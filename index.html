<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="42 is everything">
<meta property="og:url" content="https://yaoxingwei.github.io/index.html">
<meta property="og:site_name" content="42 is everything">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="42 is everything">





  
  
  <link rel="canonical" href="https://yaoxingwei.github.io/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>42 is everything</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">42 is everything</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2020/06/09/WSL使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/06/09/WSL使用/" class="post-title-link" itemprop="url">Linux使用</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2020-06-09 00:06:04 / Modified: 00:10:30" itemprop="dateCreated datePublished" datetime="2020-06-09T00:06:04+08:00">2020-06-09</time>
            </span>
          

          
            

            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h5><p>打开wsl linux目录：</p>
<pre><code>win+R
\\wsl$</code></pre><p>Create list of alternatives for python</p>
<pre><code>$ sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1
$ sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.5 2</code></pre><p>Check the python list</p>
<pre><code>$ update-alternatives --list python</code></pre><p>update alternative to select required python version</p>
<pre><code>$ sudo update-alternatives --config python</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2020/06/09/NVDLA学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/06/09/NVDLA学习/" class="post-title-link" itemprop="url">VP</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2020-06-09 00:05:00 / Modified: 00:15:23" itemprop="dateCreated datePublished" datetime="2020-06-09T00:05:00+08:00">2020-06-09</time>
            </span>
          

          
            

            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="VP-build"><a href="#VP-build" class="headerlink" title="VP build"></a>VP build</h4><ol>
<li><p>前期参考：<a href="http://nvdla.org/vp.html" target="_blank" rel="noopener">http://nvdla.org/vp.html</a></p>
</li>
<li><p>环境：</p>
<pre><code>a. default-jdk
b. Perl
c. Gcc-5/g++-5
d. Python2.7.x
e. Systemc-2.3.0</code></pre></li>
<li><p>编译hw：</p>
<pre><code>a. Change to branch nvdlav1
b. 其他按官网</code></pre></li>
<li><p>编译vp：</p>
<pre><code>a. error: ‘template&lt;class&gt; class std::auto_ptr’ is deprecated [-Werror=deprecated-declarations]
    i. Edit 根目录 CMakeLists.txt and remove &quot;-Werror&quot;，rerun cmake
    ii. Edit fpga/aws-fpga/cosim_sc_wrapper CMakeLists.txt and remove &quot;-Werror&quot;
b. error: static declaration of ‘memfd_create’ follows non-static declaration
    i. $ cd libs/qbox
    ii. Edit configure:
        1) Change memfd.h -&gt; mman.h
    iii. Edit util/memfd.c
        //#ifdef CONFIG_MEMFD
        //#include &lt;sys/memfd.h&gt;
        //#elif defined CONFIG_LINUX
        #if defined CONFIG_LINUX &amp;&amp; !defined CONFIG_MEMFD
c. Error: DTC(libfdt) version &gt;= 1.4.2 no present…
    i. $ sudo apt install libfdt-dev
d. Greenscript.cpp:xxx: error: &apos;PyString_FromString&apos; was not declared in this scope
    i. Edit CMakeCache.txt and change python3.x to python2</code></pre></li>
<li><p>Linux kernel 编译</p>
<p>按照官网来</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2020/06/08/Android源码下载及编译/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/06/08/Android源码下载及编译/" class="post-title-link" itemprop="url">Android源码下载及编译</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2020-06-08 23:39:13 / Modified: 23:42:54" itemprop="dateCreated datePublished" datetime="2020-06-08T23:39:13+08:00">2020-06-08</time>
            </span>
          

          
            

            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="Android源码下载"><a href="#Android源码下载" class="headerlink" title="Android源码下载"></a>Android源码下载</h5><p><a href="https://source.android.google.cn/setup/downloading?hl=zh-cn" target="_blank" rel="noopener">参考Android官网</a></p>
<pre><code>mkdir ~/bin
PATH=~/bin:$PATH
curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo
chmod a+x ~/bin/repo
mkdir WORKING_DIRECTORY
cd WORKING_DIRECTORY
git config --global user.name &quot;Your Name&quot;
git config --global user.email &quot;you@example.com&quot;
repo init -u https://android.googlesource.com/platform/manifest -b android-9.0.0_r1
repo sync
repo init -b android-10.0.0_r32    //创建新branch
repo sync    // 同步代码到最新
repo start android-10.0.0_r32 --all    // 所有module都更新到新branch</code></pre><h5 id="Android源码编译"><a href="#Android源码编译" class="headerlink" title="Android源码编译"></a>Android源码编译</h5><pre><code>sudo apt-get install openjdk-8-jdk    //安装依赖
export OUT_DIR_COMMON_BASE=&lt;path-to-your-out-directory&gt;    //build输出到其他folder，默认在out
source build/envsetup.sh
lunch aosp_arm-eng
make update -j8
m -j8</code></pre><blockquote>
<p>note:源码加编译需要大概200G空间。编译需要4G+ RAM，8G+ SWAP， 4G+ XEM。</p>
</blockquote>
<h5 id="其他repo操作"><a href="#其他repo操作" class="headerlink" title="其他repo操作"></a>其他repo操作</h5><pre><code>repo forall -c xxx    // xxx为linux常用命令。比如git branch
repo abandon xyz    //删除xyz这个branch</code></pre><h5 id="Android-emulator操作"><a href="#Android-emulator操作" class="headerlink" title="Android emulator操作"></a>Android emulator操作</h5><p>启动参数：</p>
<pre><code>./emulator -avd xxx -writable-system -show-kernel -kernel bzImage -wipe-data</code></pre><p>如果使用了-writable-system，就可以修改/system目录，比如把新build的so传入system/lib下</p>
<pre><code>adb remount
adb push z:/xxx.so /system/lib</code></pre><h5 id="Android-systrace操作"><a href="#Android-systrace操作" class="headerlink" title="Android systrace操作"></a>Android systrace操作</h5><p>工具目录：xxx\Android\Sdk\platform-tools\systrace\systrace.py</p>
<p>抓trace：</p>
<pre><code>python systrace.py --time=10 -o mynewtrace.html gfx xxx(各个模块)</code></pre><blockquote>
<p>TODO：如何把vendor code注册进systrace？？</p>
</blockquote>
<h5 id="Android-kernel编译和虚拟机加载"><a href="#Android-kernel编译和虚拟机加载" class="headerlink" title="Android kernel编译和虚拟机加载"></a>Android kernel编译和虚拟机加载</h5><pre><code>git clone https://android.googlesource.com/kernel/goldfish
git checkout -b xxx_branch origin/android-goldfish-xxx</code></pre><p>从虚拟机-show-kernel可以看到对应的kernel版本号，然后创建对应版本号的branch</p>
<pre><code>make ARCH=x86_64 x86_64_ranchu_defconfig
make ARCH=x86_64 -j16</code></pre><p>生成的bzImage传给emulator的-kernel参数</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2020/06/05/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/06/05/hello-world/" class="post-title-link" itemprop="url">FFMPEG stream实现web播放（基于ubuntu）</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2020-06-05 21:09:00" itemprop="dateCreated datePublished" datetime="2020-06-05T21:09:00+08:00">2020-06-05</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-06-08 23:38:24" itemprop="dateModified" datetime="2020-06-08T23:38:24+08:00">2020-06-08</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="FFMPEG-JSMPEG"><a href="#FFMPEG-JSMPEG" class="headerlink" title="FFMPEG+JSMPEG"></a>FFMPEG+JSMPEG</h3><h5 id="安装ffmpeg"><a href="#安装ffmpeg" class="headerlink" title="安装ffmpeg"></a>安装ffmpeg</h5><pre><code>$ sudo apt install ffmpeg</code></pre><h5 id="安装node-js，websocket和http-server"><a href="#安装node-js，websocket和http-server" class="headerlink" title="安装node.js，websocket和http-server"></a>安装node.js，websocket和http-server</h5><pre><code>$ sudo apt install npm
$ sudo npm install -g ws
$ sudo npm install ws
$ sudo npm install http-server -g</code></pre><h5 id="安装jsmpeg库"><a href="#安装jsmpeg库" class="headerlink" title="安装jsmpeg库"></a>安装jsmpeg库</h5><pre><code>$ git clone https://github.com/phoboslab/jsmpeg.git</code></pre><h5 id="运行jsmpeg-websocket-server"><a href="#运行jsmpeg-websocket-server" class="headerlink" title="运行jsmpeg websocket server"></a>运行jsmpeg websocket server</h5><pre><code>$ cd jsmpeg/
$ node websocket-relay.js 123456 8081 8082        
// 123456是password，8081是ffmpeg推送端口，8082是前端webSocket端口</code></pre><h5 id="运行ffmpeg发送流媒体"><a href="#运行ffmpeg发送流媒体" class="headerlink" title="运行ffmpeg发送流媒体"></a>运行ffmpeg发送流媒体</h5><pre><code>$ ffmpeg -i xxx.mp4 -q 0 -f mpegts -codec:v mpeg1video -s 1366x768 http://127.0.0.1:8081/123456
// ffmpeg格式转化需要调：ffmpeg  -re -i VID_20160708_131423.mp4 -f mpegts -codec:v mpeg1video -b:v 1000k -r 30 -s 360x640 -bf 0 -b:a 128k http://127.0.0.1:8081/123456</code></pre><h5 id="运行jsmpeg-http-server"><a href="#运行jsmpeg-http-server" class="headerlink" title="运行jsmpeg http-server"></a>运行jsmpeg http-server</h5><pre><code>$ http-server</code></pre><h5 id="浏览器打开地址"><a href="#浏览器打开地址" class="headerlink" title="浏览器打开地址"></a>浏览器打开地址</h5><pre><code>$ http://ip:8080/view-stream.html</code></pre><blockquote>
<p>note1: 播放卡顿。接着测试nvidia加速。</p>
</blockquote>
<blockquote>
<p>note2: nvidia加速有效果，但是mpeg1video是很老的格式,编解码速率不好调。放弃。</p>
</blockquote>
<h3 id="FFMPEG-FFSERVER"><a href="#FFMPEG-FFSERVER" class="headerlink" title="FFMPEG+FFSERVER"></a>FFMPEG+FFSERVER</h3><h5 id="配置ffserver（ffserver随ffmpeg自动安装）"><a href="#配置ffserver（ffserver随ffmpeg自动安装）" class="headerlink" title="配置ffserver（ffserver随ffmpeg自动安装）"></a>配置ffserver（ffserver随ffmpeg自动安装）</h5><pre><code>$ sudo vi /etc/ffserver.conf

&lt;Feed feed1.ffm&gt;
File /tmp/feed1.ffm
FileMaxSize 1000M
#ACL allow 127.0.0.1
&lt;/Feed&gt;
&lt;Stream test.webm&gt;
Feed feed1.ffm
Format webmx
AudioCodec libopus
VideoCodec libvpx
AudioChannels 2
AudioBitRate 25
AudioSampleRate 48000
VideoSize 640x480
VideoBufferSize 1024
VideoBitRate 4096
VideoFrameRate 30
AVOptionVideo qmin 16
AVOptionVideo qmax 32
AVOptionVideo flags +global_header
StartSendOnKey
PreRoll 15
&lt;/Stream&gt;

$ ffserver    //start ffserver with default conf file</code></pre><h5 id="ffmpeg全参数"><a href="#ffmpeg全参数" class="headerlink" title="ffmpeg全参数"></a>ffmpeg全参数</h5><pre><code>ffmpeg -f lavfi -i &quot;xxx.mkv&quot; \
   -c:v libvpx -threads 4 -speed 6 -pix_fmt yuv420p -b:v 512k -r 30 \
   -c:a libopus -threads 4 -b:a 256k -ac 2 -ar 48000 \
   -f ffm http://127.0.0.1:8090/feed1.ffm</code></pre><h5 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h5><pre><code>http://ip:8090/test.webm</code></pre><blockquote>
<p>note: ios不支持webm。需要装插件。其他平台播放正常。</p>
</blockquote>
<blockquote>
<p>TODO: 时间戳不正常。不能跳跃播放。</p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2019/12/20/buildroot搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/12/20/buildroot搭建/" class="post-title-link" itemprop="url">buildroot搭建</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-12-20 14:14:00" itemprop="dateCreated datePublished" datetime="2019-12-20T14:14:00+08:00">2019-12-20</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-06-08 23:34:26" itemprop="dateModified" datetime="2020-06-08T23:34:26+08:00">2020-06-08</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-默认项目启动"><a href="#1-默认项目启动" class="headerlink" title="1. 默认项目启动"></a>1. 默认项目启动</h3><ol>
<li><p>Download buildroot latest version：<br><a href="https://buildroot.org/download.html" target="_blank" rel="noopener">Download buildroot</a></p>
</li>
<li><p>build 默认配置好的项目，如qemu-aarch64:</p>
<pre><code>$ make qemu_aarch64_virt_defconfig
$ make</code></pre><blockquote>
<p>不要多线程，会导致先后顺序出错</p>
</blockquote>
</li>
<li><p>默认配置会download/build kernel和文件系统，生成在output/images，运行：</p>
<pre><code>$ qemu-system-aarch64 -M virt -cpu cortex-a53 -nographic -smp 1 -kernel output/images/Image -append &quot;rootwait root=/dev/vda console=ttyAMA0&quot; -netdev user,id=eth0 -device virtio-net-device,netdev=eth0 -drive file=output/images/rootfs.ext4,if=none,format=raw,id=hd0 -device virtio-blk-device,drive=hd0</code></pre></li>
</ol>
<h3 id="2-添加UBOOT"><a href="#2-添加UBOOT" class="headerlink" title="2. 添加UBOOT"></a>2. 添加UBOOT</h3><ol>
<li><p>在配置里面选中UBOOT</p>
<pre><code>$ make menuconfig
  -&gt; Bootloaders
    -&gt; U-Boot
      -&gt; U-Boot configuration(using an in-tree board defconfig file)
      (qemu_arm64) Board defconfig
$ make</code></pre></li>
<li><p>load Uboot</p>
<pre><code>$ qemu-system-aarch64 -M virt -cpu cortex-a53 -m 256 -bios output/images/u-boot.bin --nographic</code></pre></li>
</ol>
<h3 id="3-添加UBOOT启动参数，load-kernel和fs"><a href="#3-添加UBOOT启动参数，load-kernel和fs" class="headerlink" title="3. 添加UBOOT启动参数，load kernel和fs"></a>3. 添加UBOOT启动参数，load kernel和fs</h3>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2019/08/21/Valgrind-在ARM平台使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/21/Valgrind-在ARM平台使用/" class="post-title-link" itemprop="url">内存泄漏debug - Valgrind/mtrace 在ARM平台使用</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-08-21 17:14:58" itemprop="dateCreated datePublished" datetime="2019-08-21T17:14:58+08:00">2019-08-21</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-06-08 23:31:12" itemprop="dateModified" datetime="2020-06-08T23:31:12+08:00">2020-06-08</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Valgrind-usage"><a href="#Valgrind-usage" class="headerlink" title="Valgrind usage"></a>Valgrind usage</h1><h4 id="下载valgrind源码"><a href="#下载valgrind源码" class="headerlink" title="下载valgrind源码"></a>下载valgrind源码</h4><p><a href="http://www.valgrind.org/downloads/" target="_blank" rel="noopener">源码地址</a></p>
<h4 id="交叉编译"><a href="#交叉编译" class="headerlink" title="交叉编译"></a>交叉编译</h4><pre><code>./autogen.sh
./configure --host=arm-linux-gnueabihf --prefix=/xxx/valgrind-3.15.0/out/ CC=arm-linux-gnueabihf-gcc
make
make install</code></pre><h4 id="copy可执行文件到arm平台"><a href="#copy可执行文件到arm平台" class="headerlink" title="copy可执行文件到arm平台"></a>copy可执行文件到arm平台</h4><pre><code>scp out/bin/valgrind xxx.xxx.xxx.xxx:/home/xxx
scp out/lib/valgrind/memcheck-arm-linux xxx.xxx.xxx.xxx:/home/xxx/lib</code></pre><blockquote>
<p>note: 本文只使用memcheck工具，如果需要其他工具，需要copy相应的lib库的文件到arm平台</p>
</blockquote>
<h4 id="配置运行环境"><a href="#配置运行环境" class="headerlink" title="配置运行环境"></a>配置运行环境</h4><pre><code>export VALGRIND_LIB=/home/xxx/lib</code></pre><h4 id="运行valgrind"><a href="#运行valgrind" class="headerlink" title="运行valgrind"></a>运行valgrind</h4><pre><code>./valgrind --leak-check=full --log-file=/home/xxx/log ./xxx(Linux program)</code></pre><blockquote>
<p>note: valgrind需要libc支持debug info。如果当前文件系统libc不支持。可以copy交叉工具链的带debug info的libc到当前arm平台。然后设置LD_LIBRARY_PATH。</p>
</blockquote>
<h1 id="mtrace-usage"><a href="#mtrace-usage" class="headerlink" title="mtrace usage"></a>mtrace usage</h1><p>代码格式：</p>
<pre><code>#include &lt;mcheck.h&gt;
void mtrace(void);
// trace code ...
// ...
// ...
void muntrace(void);</code></pre><p>设置输出log地址：</p>
<pre><code>$ export MALLOC_TRACE=/home/xxx/xxx/trace.log</code></pre><p>输入log格式转换：</p>
<pre><code>mtrace xxx&lt;program&gt; trace.log &gt; trace_trans.log</code></pre><h1 id="内存泄漏tips"><a href="#内存泄漏tips" class="headerlink" title="内存泄漏tips"></a>内存泄漏tips</h1><ol>
<li>使用valgrind可以比较方便查看内存使用情况</li>
<li>mtrace输出的memory地址，结合出错memory地址，可以发现是否是内存越界。如果是，多检查字符串操作。</li>
<li>alloc/free函数重新封装，可以通过code打印memory使用情况，类似mtrace。</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2019/07/19/Linux开发/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/19/Linux开发/" class="post-title-link" itemprop="url">Linux开发 - debug线程cpu占用过高</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-07-19 12:18:34" itemprop="dateCreated datePublished" datetime="2019-07-19T12:18:34+08:00">2019-07-19</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-06-08 23:31:12" itemprop="dateModified" datetime="2020-06-08T23:31:12+08:00">2020-06-08</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-重编译功能完全的ps命令-optional"><a href="#1-重编译功能完全的ps命令-optional" class="headerlink" title="1. 重编译功能完全的ps命令(optional)"></a>1. 重编译功能完全的ps命令(optional)</h3><blockquote>
<p> <a href="https://gitlab.com/procps-ng/procps" target="_blank" rel="noopener">源码地址</a></p>
</blockquote>
<h6 id="编译脚本"><a href="#编译脚本" class="headerlink" title="编译脚本"></a>编译脚本</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">CROSS_COMPILE=arm-linux-gnueabihf-</span><br><span class="line">HOST=arm-linux-gnueabihf</span><br><span class="line">TARGET_DIR=$(cd `dirname $<span class="number">0</span>`; pwd)/out</span><br><span class="line"></span><br><span class="line">build_procps() &#123;</span><br><span class="line">    ac_cv_func_realloc_0_nonnull=yes \</span><br><span class="line">    ac_cv_func_malloc_0_nonnull=yes \</span><br><span class="line">    ./configure --host=$HOST --prefix=$TARGET_DIR --enable-<span class="keyword">static</span> --without-ncurses</span><br><span class="line">    make ; make install || <span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">./autogen.sh  <span class="meta"># maybe need to install libtool-bin</span></span><br><span class="line">build_procps</span><br></pre></td></tr></table></figure>

<h3 id="2-利用ps命令查看线程占用情况"><a href="#2-利用ps命令查看线程占用情况" class="headerlink" title="2. 利用ps命令查看线程占用情况"></a>2. 利用ps命令查看线程占用情况</h3><pre><code>ps H -eo user,pid,ppid,tid,time,%cpu,cmd --sort=%cpu</code></pre><blockquote>
<p> 该命令可以查看各进程&amp;线程占用cpu情况并排序显示。</p>
</blockquote>
<h3 id="3-根据线程id查找代码对应thread"><a href="#3-根据线程id查找代码对应thread" class="headerlink" title="3. 根据线程id查找代码对应thread"></a>3. 根据线程id查找代码对应thread</h3><p>  <img src="/images/pasted-2.png" alt="upload successful"></p>
<p>在相应的线程代码里加打印，输出线程tid。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s tid:%lu pid:%u\n"</span>, __func__, syscall(SYS_gettid), (<span class="keyword">unsigned</span> <span class="keyword">int</span>)pthread_self())</span><br></pre></td></tr></table></figure>

<h3 id="总结：多数占用高是线程pooling导致。可考虑阻塞方式。"><a href="#总结：多数占用高是线程pooling导致。可考虑阻塞方式。" class="headerlink" title="总结：多数占用高是线程pooling导致。可考虑阻塞方式。"></a>总结：多数占用高是线程pooling导致。可考虑阻塞方式。</h3>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2019/07/12/多用户编辑hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/12/多用户编辑hexo/" class="post-title-link" itemprop="url">多用户编辑hexo</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-07-12 00:33:29" itemprop="dateCreated datePublished" datetime="2019-07-12T00:33:29+08:00">2019-07-12</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-06-08 23:49:11" itemprop="dateModified" datetime="2020-06-08T23:49:11+08:00">2020-06-08</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-本地上传"><a href="#1-本地上传" class="headerlink" title="1. 本地上传"></a>1. 本地上传</h3><pre><code>git init
git add XXX //添加本地文件到仓库        
git commit -m &quot;blog源文件&quot; //添加commit
git branch hexo //添加本地仓库分支hexo
git remote add origin &lt;server&gt;    // 添加远程仓库
git push origin hexo //将本地仓库的源文件推送到远程仓库hexo分支</code></pre><blockquote>
<p>Note1: 不建议将配置文件传上去:<br>.DS_Store<br>Thumbs.db<br>db.json<br><em>.log<br>node_modules/<br>public/<br>.deploy</em>/<br>_config.yml</p>
</blockquote>
<blockquote>
<p>Note2: 需要删除themes下面的 .git 文件夹。不然会冲突导致上传失败。</p>
</blockquote>
<h3 id="其他用户操作"><a href="#其他用户操作" class="headerlink" title="其他用户操作"></a>其他用户操作</h3><pre><code>git clone &lt;server&gt; hexo //&lt;server&gt; 是指在线仓库的地址
cd hexo
git pull origin master
git checkout -b hexo origin/hexo
sudo npm install --unsafe-perm --verbose -g hexo</code></pre><h3 id="同步操作"><a href="#同步操作" class="headerlink" title="同步操作"></a>同步操作</h3><pre><code>git pull origin hexo  //先pull完成本地与远端的融合
hexo new post &quot; new blog name&quot;
git add source
git commit -m &quot;XX&quot;
git push origin hexo
hexo d -g  // TODO: need test</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2019/07/11/NAS和aria2配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/11/NAS和aria2配置/" class="post-title-link" itemprop="url">NAS配置</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-07-11 11:27:50" itemprop="dateCreated datePublished" datetime="2019-07-11T11:27:50+08:00">2019-07-11</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-06-13 20:15:33" itemprop="dateModified" datetime="2020-06-13T20:15:33+08:00">2020-06-13</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-Ubuntu环境设置"><a href="#1-Ubuntu环境设置" class="headerlink" title="1. Ubuntu环境设置"></a>1. Ubuntu环境设置</h1><h2 id="1-git-config"><a href="#1-git-config" class="headerlink" title="1. git config"></a>1. git config</h2><pre><code>sudo apt install git
git config --global user.name &quot;xxx&quot;
git config --global user.email &quot;xxx@xxx.com&quot;</code></pre><h2 id="2-generate-ssh-key"><a href="#2-generate-ssh-key" class="headerlink" title="2. generate ssh key"></a>2. generate ssh key</h2><pre><code>ssh-keygen -t rsa -C &quot;xxx@xxx.com&quot;</code></pre><h2 id="3-install-samba"><a href="#3-install-samba" class="headerlink" title="3. install samba"></a>3. install samba</h2><pre><code>sudo apt install samba</code></pre><h2 id="4-edit-samba-config-file-for-win-share"><a href="#4-edit-samba-config-file-for-win-share" class="headerlink" title="4. edit samba config file for win share"></a>4. edit samba config file for win share</h2><p>config file path: /etc/samba/smb.conf</p>
<pre><code>[share]
comment = t610 samba share
path = /home/yxw/share
browseable = yes
 writeable = yes
#guest ok = no
public = yes
#security = share
#admin user = root
create mask = 0777
directory mask = 0777
forceuser = root
forcegroup = root
display charset = UTF-8
unix charset = UTF-8
dos charset = UTF-8</code></pre><blockquote>
<p>Note: access samba path in windows: \\192.168.xxx.xxx\share</p>
</blockquote>
<h2 id="5-set-nfs-for-linux-share"><a href="#5-set-nfs-for-linux-share" class="headerlink" title="5. set nfs for linux share"></a>5. set nfs for linux share</h2><pre><code>sudo apt-get install nfs-kernel-server
sudo vi /etc/exports
    /home/share/nfsroot *(rw,sync,insecure,no_root_squash,no_subtree_check)
sudo /etc/init.d/rpcbind restart
sudo /etc/init.d/nfs-kernel-server restart
sudo exportfs -r
sudo mount -t nfs localhost:/home/share/nfsroot  /mnt    # test mount and access method</code></pre><h2 id="6-transmission"><a href="#6-transmission" class="headerlink" title="6. transmission"></a>6. transmission</h2><p>安装</p>
<pre><code>sudo apt install transmission-daemon</code></pre><p>配置</p>
<pre><code>vi ~/.config/transmission-daemon/settings.json</code></pre>   <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"download-dir"</span>: <span class="string">"xxx/xxx"</span>,</span><br><span class="line"><span class="string">"incomplete-dir"</span>: <span class="string">"/xxx/xxx/incomplete"</span>,</span><br><span class="line"><span class="string">"incomplete-dir-enabled"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"rpc-authentication-required"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"rpc-bind-address"</span>: <span class="string">"0.0.0.0"</span>,</span><br><span class="line"><span class="string">"rpc-enabled"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"rpc-host-whitelist"</span>: <span class="string">"*"</span>,</span><br><span class="line"><span class="string">"rpc-host-whitelist-enabled"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"rpc-password"</span>: <span class="string">"xxxxxx"</span>,</span><br><span class="line"><span class="string">"rpc-port"</span>: <span class="number">9091</span>,</span><br><span class="line"><span class="string">"rpc-url"</span>: <span class="string">"/transmission/"</span>,</span><br><span class="line"><span class="string">"rpc-username"</span>: <span class="string">"xxx"</span>,</span><br><span class="line"><span class="string">"rpc-whitelist"</span>: <span class="string">"*"</span>,</span><br><span class="line"><span class="string">"rpc-whitelist-enabled"</span>: <span class="literal">true</span>,</span><br></pre></td></tr></table></figure>

<p>运行</p>
<pre><code>sudo systemctl start transmission-daemon.service</code></pre><p>访问</p>
<pre><code>http://&lt;ip&gt;:9091/transmission/web/</code></pre><h6 id="下载权限问题"><a href="#下载权限问题" class="headerlink" title="下载权限问题"></a>下载权限问题</h6><pre><code>sudo chmod -R 777 downloads    //修改下载文件夹权限</code></pre><p>停止服务</p>
<pre><code>sudo systemctl stop transmission-daemon.service</code></pre><p>修改用户名</p>
<pre><code>sudo vi /etc/init.d/transmission-daemon</code></pre><p>修改USER变量为需要的用户名，保存 </p>
<pre><code>USER=xxx</code></pre><p>添加信息</p>
<pre><code>sudo systemctl edit transmission-daemon.service</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">User=aa</span><br></pre></td></tr></table></figure>

<p>重启服务</p>
<pre><code>sudo systemctl daemon-reload
sudo systemctl start transmission-daemon.service</code></pre><h2 id="7-FTP-server"><a href="#7-FTP-server" class="headerlink" title="7. FTP server"></a>7. FTP server</h2><p>安装</p>
<pre><code>sudo apt-get install vsftpd</code></pre><p>修改配置文件</p>
<pre><code>sudo vi /etc/vsftpd.conf</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">listen=YES</span><br><span class="line">#listen_ipv6=NO</span><br><span class="line">anonymous_enable=NO</span><br><span class="line">local_enable=YES</span><br><span class="line">write_enable=YES</span><br><span class="line">local_umask=<span class="number">077</span></span><br><span class="line">#anon_upload_enable=YES</span><br><span class="line">#anon_mkdir_write_enable=YES</span><br><span class="line">dirmessage_enable=YES</span><br><span class="line">use_localtime=YES</span><br><span class="line">xferlog_enable=YES</span><br><span class="line">connect_from_port_20=YES</span><br><span class="line">#chown_uploads=YES</span><br><span class="line">#chown_username=whoever</span><br><span class="line">#xferlog_file=/var/<span class="built_in">log</span>/vsftpd.<span class="built_in">log</span></span><br><span class="line">#xferlog_std_format=YES</span><br><span class="line">#idle_session_timeout=<span class="number">600</span></span><br><span class="line">#data_connection_timeout=<span class="number">120</span></span><br><span class="line">#nopriv_user=ftpsecure</span><br><span class="line">#async_abor_enable=YES</span><br><span class="line">#ascii_upload_enable=YES</span><br><span class="line">#ascii_download_enable=YES</span><br><span class="line">#ftpd_banner=Welcome to blah FTP service.</span><br><span class="line">#deny_email_enable=YES</span><br><span class="line">#banned_email_file=/etc/vsftpd.banned_emails</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vsftpd.chroot_list</span><br><span class="line">#ls_recurse_enable=YES</span><br><span class="line">secure_chroot_dir=/var/run/vsftpd/empty</span><br><span class="line">pam_service_name=ftp</span><br><span class="line">rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</span><br><span class="line">rsa_private_key_file=/etc/ssl/<span class="keyword">private</span>/ssl-cert-snakeoil.key</span><br><span class="line">ssl_enable=NO</span><br><span class="line">utf8_filesystem=YES</span><br></pre></td></tr></table></figure>

<p>添加用户list文件</p>
<pre><code>sudo /etc/vsftpd.chroot_list
username</code></pre><p>运行</p>
<pre><code>systemctl start vsftpd    //service vsftpd start</code></pre><h2 id="8-ubuntu18-04-双网卡绑定"><a href="#8-ubuntu18-04-双网卡绑定" class="headerlink" title="8. ubuntu18.04 双网卡绑定"></a>8. ubuntu18.04 双网卡绑定</h2><pre><code>sudo vi /etc/netplan/50-cloud-init.yaml</code></pre>   <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    enp3s0:</span><br><span class="line">        addresses: []</span><br><span class="line">        dhcp4: no</span><br><span class="line">        dhcp6: no</span><br><span class="line">        optional: <span class="literal">true</span></span><br><span class="line">    enx00e04c680fcf:</span><br><span class="line">        addresses: []</span><br><span class="line">        dhcp4: no</span><br><span class="line">        dhcp6: no</span><br><span class="line">        optional: <span class="literal">true</span></span><br><span class="line">  bonds:</span><br><span class="line">    bond0:</span><br><span class="line">        addresses: [<span class="number">192.</span>xxx.xxxx.xxx/<span class="number">24</span>]</span><br><span class="line">        gateway4: <span class="number">192.168</span><span class="number">.5</span><span class="number">.1</span></span><br><span class="line">        nameservers:</span><br><span class="line">            addresses: [<span class="number">192.</span>xxx.xxx.xxx,<span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span>]</span><br><span class="line">        interfaces:</span><br><span class="line">        - enp3s0</span><br><span class="line">        - enx00e04c680fcf</span><br><span class="line">version: <span class="number">2</span></span><br></pre></td></tr></table></figure>


          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yaoxingwei.github.io/2019/07/10/博客搭建（github-pages-hexo-hexo-admin）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yaoxingwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="42 is everything">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/10/博客搭建（github-pages-hexo-hexo-admin）/" class="post-title-link" itemprop="url">博客搭建（github pages + hexo + hexo-admin）</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-07-10 16:20:00" itemprop="dateCreated datePublished" datetime="2019-07-10T16:20:00+08:00">2019-07-10</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-06-08 23:31:12" itemprop="dateModified" datetime="2020-06-08T23:31:12+08:00">2020-06-08</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-github-pages-hexo配置"><a href="#1-github-pages-hexo配置" class="headerlink" title="1. github pages + hexo配置"></a>1. github pages + hexo配置</h3><pre><code>1. 参考：https://www.cnblogs.com/jackyroc/p/7681938.html
2. 注意github pages的setting，repo name 一定是 xxx.github.io的格式</code></pre><p>   <img src="/images/pasted-0.png" alt="upload successful"></p>
<h3 id="2-hexo编辑器"><a href="#2-hexo编辑器" class="headerlink" title="2. hexo编辑器"></a>2. hexo编辑器</h3><pre><code>1. 找了很多，发现个hexo原生的hexo-admin，方便快捷。配置参考：
https://blog.csdn.net/light_fisher/article/details/85145204
2. 后续会用更复杂的编译器吧......</code></pre><h3 id="3-markdown语法"><a href="#3-markdown语法" class="headerlink" title="3. markdown语法"></a>3. markdown语法</h3><p><a href="https://www.jianshu.com/p/335db5716248" target="_blank" rel="noopener">参考文章：(https://www.jianshu.com/p/335db5716248)</a></p>
<h6 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h6><pre><code>#
##
...
#####</code></pre><h6 id="高亮"><a href="#高亮" class="headerlink" title="高亮"></a>高亮</h6><pre><code>&gt;</code></pre><h6 id="插入链接或图片"><a href="#插入链接或图片" class="headerlink" title="插入链接或图片"></a>插入链接或图片</h6><pre><code>[点击跳转至百度](http://www.baidu.com)
![图片](https://upload-images.jianshu.io/upload_images/703764-605e3cc2ecb664f6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</code></pre><blockquote>
<p>注：引用图片和链接的唯一区别就是在最前方添加一个感叹号。</p>
</blockquote>
<h6 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h6><pre><code>* 黄瓜
* 玉米
* 茄子

+ 黄瓜
+ 玉米
+ 茄子

- 黄瓜
- 玉米
- 茄子

1. 黄瓜
2. 玉米
3. 茄子</code></pre><blockquote>
<p>注：如果在单一列表项中包含了多个段落，为了保证渲染正常，*与段落首字母之间必须保留四个空格</p>
</blockquote>
<blockquote>
<p>如果在列表中加入了区块引用，区域引用标记符也需要缩进4个空格</p>
</blockquote>
<h6 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h6><pre><code>***
---</code></pre><h6 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h6><pre><code>*这里是斜体*
_这里是斜体_

**这里是加粗**
__这里是加粗__</code></pre><h6 id="插入代码"><a href="#插入代码" class="headerlink" title="插入代码"></a>插入代码</h6><pre><code>用反引号``包裹单行，多反引号包裹多行，如下:
\`\`\`c/phthon/ruby/phy
code
\`\`\`</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/* 我的第一个 C 程序 */</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Hello, World! \n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="插入表格"><a href="#插入表格" class="headerlink" title="插入表格"></a>插入表格</h6><pre><code>表头|条目一|条目二
:---:|:---:|:---:
项目|项目一|项目二</code></pre><h6 id="特殊符号"><a href="#特殊符号" class="headerlink" title="特殊符号"></a>特殊符号</h6><pre><code>Markdown使用反斜杠\插入语法中用到的特殊符号。在Markdown中，主要有以下几种特殊符号需要处理：
\   反斜线
`   反引号
*   星号
_   底线
{}  花括号
[]  方括号
()  括弧
#   井字号
+   加号
-   减号
.   英文句点
!   惊叹号</code></pre><h6 id="文字上色"><a href="#文字上色" class="headerlink" title="文字上色"></a>文字上色</h6><pre><code>1. 先用Markdown编辑完成
2. 导出为html，在需要上色的部分手动添加标签&lt;font color=&apos;#ff0000&apos;&gt;&lt;/font&gt;保存即可。</code></pre><h6 id="换行："><a href="#换行：" class="headerlink" title="换行："></a>换行：</h6><pre><code>&lt;br&gt;</code></pre><h6 id="段首缩进："><a href="#段首缩进：" class="headerlink" title="段首缩进："></a>段首缩进：</h6><pre><code>&amp;ensp; or &amp;#8194; 表示一个半角的空格
&amp;emsp; or &amp;#8195;  表示一个全角的空格
&amp;emsp;&amp;emsp; 两个全角的空格（用的比较多）
&amp;nbsp; or &amp;#160; 不断行的空白格</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">yaoxingwei</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yaoxingwei</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.2.0"></script>



  

  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
